{% from '_macros.html' import icon %}

{% macro render_flags(asset) %}
    {% set file = asset.get_primary_image() %}
    {% if file %}
        <a href="{{ url_for('file.details_view', id=file.id) }}">
            {{- icon("image") -}}
        </a>
    {% else %}
        {{ icon("image", faded=True) }}
    {% endif %}
    {% if asset.get_dumps() %}
        <a href="{{ url_for('asset.details_view', id=asset.id) }}">
            {{ icon("save") }}
        </a>
    {% else %}
        {{ icon("save", faded=True) }}
    {% endif %}
    {% if asset.parent %}
        <a href="{{ url_for('asset.details_view', id=asset.parent.id) }}">
            {{- icon("jar") -}}
        </a>
    {% else %}
        {{- icon("jar", faded=True) -}}
    {% endif %}
    {% for transaction in asset.transactions %}
        <a href="{{ url_for('transaction.details_view', id=transaction.id) }}">
            {{- icon("handshake") -}}
        </a>
    {% endfor %}
{% endmacro %}

{% macro new_asset_form(show_category_text=True, parent_id=None) %}
    {# XXX refactor the style out #}
    <style>
        .category-select {
            display: flex;
            margin-left: 12px;
            margin-right: 12px;
        }

        .category-row {
            margin-bottom: 8px;
            display: flex;
        }
        .category-btn {
            width: 100px;
        }
    </style>

    {% set layout = [
            ['game', 'software', 'multimedia', 'rewritable media'],
            ['literature', 'packaging'],
            ['console', 'console accesory'],
            ['computer', 'computer accessory', 'computer component'],
            ['keyboard', 'computer mouse', 'television', 'monitor'],
            ['location', 'other']
        ]
    %}

    {% set shortnames = {
            'rewritable media': 'rw. media',
            'console accesory': 'con. accessory',
            'computer accessory': 'pc accessory',
            'computer component': 'pc component',
            'computer mouse': 'mouse'
        }
    %}

    <div class="category-select">
        {% if show_category_text %}
            <div style="width: 120px; font-weight: bold;">
                Category
            </div>
        {% endif %}
        <div>
            {% for row in layout %}
                <div class="category-row">
                    {% for category in row %}
                        {% set shortname = shortnames.get(category, category) %}
                        <a
                            class="btn category-btn"
                            href="{{ url_for('.create_view', category=category.replace(' ', '_'), parent_id=parent_id) }}"
                        >
                            {{ shortname.capitalize() }}
                        </a>
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
    </div>
{% endmacro %}